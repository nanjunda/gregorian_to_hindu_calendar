<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hindu Panchanga Converter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Outfit:wght@300;500;700&display=swap"
        rel="stylesheet">
    <!-- Mobile Web Compatibility -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/icon.png') }}">
</head>

<body>
    <div class="container">
        <header>
            <h1>Hindu Panchanga</h1>
            <p>Precise Panchanga Insights</p>
        </header>

        <main>
            <section class="card glass">
                <form id="panchanga-form">
                    <div class="input-group full-width">
                        <label for="title">Event Title</label>
                        <input type="text" id="title" name="title" placeholder="e.g. Birthday, Festival..." required>
                    </div>
                    <div class="input-group full-width">
                        <label>Language</label>
                        <div class="lang-selector">
                            <button type="button" class="lang-btn active" data-lang="EN">EN</button>
                            <button type="button" class="lang-btn" data-lang="KN">KN</button>
                            <button type="button" class="lang-btn" data-lang="SA">SA</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="date">Date</label>
                        <input type="text" id="date" name="date" required>
                    </div>
                    <div class="input-group">
                        <label for="time">Time (24h)</label>
                        <input type="time" id="time" name="time" required>
                    </div>
                    <div class="input-group">
                        <label for="location">Location</label>
                        <input type="text" id="location" name="location" placeholder="e.g. Town, State, Country"
                            required>
                        <button type="button" id="geo-btn" title="Use current location">üìç</button>
                        <small class="input-hint">Village, Town, City, or Landmark</small>
                    </div>
                    <button type="submit" id="submit-btn">Convert to Panchanga</button>
                </form>
            </section>

            <section id="result-container" class="card glass hidden">
                <div class="result-header">
                    <h2 id="res-title">Result Title</h2>
                    <p id="res-location">Location Detail</p>
                </div>

                <div class="grid">
                    <div class="grid-item">
                        <span class="label">Samvatsara</span>
                        <span class="value" id="res-samvatsara">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Saka Varsha <small
                                style="color:var(--text-muted); font-size:0.7em;">(Civil)</small></span>
                        <span class="value" id="res-saka-year">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Masa</span>
                        <span class="value" id="res-masa">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Paksha</span>
                        <span class="value" id="res-paksha">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Tithi</span>
                        <span class="value" id="res-tithi">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Vara</span>
                        <span class="value" id="res-vara">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Nakshatra</span>
                        <span class="value" id="res-nakshatra">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Yoga</span>
                        <span class="value" id="res-yoga">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Rashi</span>
                        <span class="value" id="res-rashi">-</span>
                    </div>
                    <div class="grid-item">
                        <span class="label">Lagna</span>
                        <span class="value" id="res-lagna">-</span>
                    </div>
                </div>

                <div class="extra-details">
                    <p>Sunrise: <span id="res-sunrise">-</span> | Sunset: <span id="res-sunset">-</span></p>
                </div>

                <div id="next-birthday-section" class="special-card">
                    <span class="label" id="res-next-occurrence-label">‚ú® Next occurrence as per Hindu Panchanga</span>
                    <span class="value" id="res-next-birthday">-</span>
                </div>

                <button id="download-ical-btn" class="secondary-btn">Download Next 20 Occurrences (.ics)</button>

                <div class="ai-insight-cta">
                    <a href="/insights" id="ai-insight-link" class="insight-link">
                        ‚ú® Explore Astronomical & Mythological Context
                    </a>
                </div>
            </section>

            <section id="fact-cards" class="card glass hidden">
                <h3>Did you know?</h3>
                <div id="fact-cards-container" class="grid"></div>
            </section>

            <section id="skyshot-section" class="card glass hidden">
                <h3>üåå Celestial Perspective</h3>
                <div id="skyshot-dynamic-title" class="skyshot-title-area">
                    <p class="skyshot-subtitle">Moon position in</p>
                    <h4 id="skyshot-main-title" class="skyshot-main-title">-</h4>
                </div>
                <div id="skyshot-container">
                    <div id="skyshot-loader" class="hidden">
                        <div class="spinner"></div>
                        <p>Generating perspective...</p>
                    </div>
                    <img id="skyshot-image" src="" alt="Celestial perspective showing Moon and Nakshatras">
                </div>
                <div id="skyshot-caption-area" class="caption-area">
                    <p id="skyshot-caption" class="caption">
                        This ecliptic wheel shows precisely where the Moon was positioned across the 27 Nakshatras.
                    </p>
                    <p class="educational-note">Ecliptic wheel showing the Moon's sidereal position among the Nakshatras
                    </p>
                </div>
            </section>

            <section id="solar-system-section" class="card glass hidden">
                <h3>ü™ê Cosmic Alignment</h3>
                <div id="solar-dynamic-title" class="skyshot-title-area">
                    <p id="solar-main-title" class="skyshot-main-title">-</p>
                </div>
                <div id="solar-system-container">
                    <div id="solar-loader" class="hidden">
                        <div class="spinner"></div>
                        <p>Mapping the alignment...</p>
                    </div>
                    <img id="solar-system-image" src="" alt="Top-down view of cosmic planetary alignment">
                </div>
                <p class="caption">
                    A heliocentric (Sun-centered) top-down view of the solar system at the chosen moment.
                    Orbits are adjusted for visibility.
                </p>
            </section>


            <div id="loader" class="hidden">
                <div class="spinner"></div>
                <p>Consulting the Stars...</p>
            </div>
        </main>

        <footer>
            <div class="footer-links" style="margin-bottom: 1rem;">
                <a href="/guide"
                    style="color: var(--secondary); text-decoration: none; font-weight: 600; font-size: 0.9rem;">üìò
                    Explore Interactive Student Guide</a>
            </div>
            <p>&copy; 2026 Hindu Panchanga Engine</p>
            <p class="privacy-note">Privacy Note: All calculations happen in real-time. No location or personal data is
                stored on our servers.</p>
        </footer>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <!-- Flatpickr (Dark Theme) for consistent Cross-Browser Date Picking -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://npmcdn.com/flatpickr/dist/themes/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script>
        // Initialize Flatpickr
        document.addEventListener('DOMContentLoaded', function () {
            flatpickr("#date", {
                altInput: true,
                altFormat: "F j, Y",
                dateFormat: "Y-m-d",
                defaultDate: new Date(),
                monthSelectorType: "dropdown",
                theme: "dark",
                animate: true,
                onReady: function (selectedDates, dateStr, instance) {
                    const yearInput = instance.calendarContainer.querySelector(".numInput.cur-year");
                    if (yearInput) {
                        const yearSelect = document.createElement("select");
                        yearSelect.className = "flatpickr-year-select";
                        for (let y = 1900; y <= 2100; y++) {
                            const opt = document.createElement("option");
                            opt.value = y;
                            opt.text = y;
                            if (y === instance.currentYear) opt.selected = true;
                            yearSelect.appendChild(opt);
                        }
                        yearInput.parentNode.replaceChild(yearSelect, yearInput);
                        yearSelect.addEventListener("change", (e) => {
                            instance.changeYear(parseInt(e.target.value));
                        });
                        instance.yearSelect = yearSelect;
                    }
                },
                onYearChange: function (selectedDates, dateStr, instance) {
                    if (instance.yearSelect) {
                        instance.yearSelect.value = instance.currentYear;
                    }
                }
            });
        });
    </script>
</body>

</html>